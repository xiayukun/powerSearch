(node:2949) Warning: Accessing non-existent property 'padLevels' of module exports inside circular dependency
(Use `node --trace-warnings ...` to show where the warning was created)
2024-07-22 11:45:37 ------开始定时任务执行---------
2024-07-22 11:45:37 执行sql 
			SELECT
				id
			FROM
				power_user
		
Mon, 22 Jul 2024 03:45:37 GMT body-parser deprecated undefined extended: provide extended option at file:/root/powerSearch/behind/base.mjs:11:21
2024-07-22 11:45:37 启动服务，端口是 16853
2024-07-22 11:45:37 ###开始记录电费数据： 6010921
2024-07-22 11:45:38 执行sql 
			SELECT
				id as power_id,
				balance,
				kwh_sum,
				remark,
				update_date,
				power_day.date AS day_date,
				kwh as day_kwh,
				power_day.amount AS day_amount,
				power_recharge.datetime AS recharge_datetime,
				power_recharge.amount AS amount
			FROM
				power_user
			LEFT JOIN power_day ON power_user.id = power_day.power_id
			LEFT JOIN power_recharge ON power_recharge.power_id = power_user.id
			WHERE
				power_user.id = '6010921'
			ORDER BY
				power_day.date DESC,
				power_recharge.datetime DESC
			LIMIT 1
			
2024-07-22 11:45:38 执行sql 
			UPDATE power_user
			SET balance = 44.825,
			kwh_sum = 2689.92,
			update_date = '2024-07-22'
			WHERE
				id = '6010921'
			
2024-07-22 11:45:38 ###结束记录电费数据： 6010921
2024-07-22 11:45:41 ------结束定时任务执行---------
2024-07-22 11:46:33 接收到POST请求
2024-07-22 11:46:33 http://weixin.xiayukun.asia:444/?signature=87d473400cb98e742d8e30c93ef1e2f04c7058b9&timestamp=1721619992&nonce=1677644981&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 11:46:33 Query:{"signature":"87d473400cb98e742d8e30c93ef1e2f04c7058b9","timestamp":"1721619992","nonce":"1677644981","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 11:46:33 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721619991"],"msgtype":["text"],"content":["2"],"msgid":["24647671246034472"]}}
2024-07-22 11:46:33 来文字消息了：2
2024-07-22 11:46:33 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 11:46:33',
						'24647671246034472',
						'2'
					)
		
2024-07-22 11:46:33 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 11:46:33 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 11:46:33 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 11:46:33',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 11:46:33 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 11:46:37 接收到POST请求
2024-07-22 11:46:37 http://weixin.xiayukun.asia:444/?signature=6fbeaa6f7ad771cad5035f6efb8240b2ce868091&timestamp=1721619997&nonce=97956492&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 11:46:37 Query:{"signature":"6fbeaa6f7ad771cad5035f6efb8240b2ce868091","timestamp":"1721619997","nonce":"97956492","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 11:46:37 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721619996"],"msgtype":["text"],"content":["2"],"msgid":["24647671246034472"]}}
2024-07-22 11:46:37 来文字消息了：2
2024-07-22 11:46:37 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 11:46:37',
						'24647671246034472',
						'2'
					)
		
2024-07-22 11:46:37 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 11:46:37 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 2
			ORDER BY
				sort
			
2024-07-22 11:46:37 执行sql 
			SELECT
				power_user.id AS power_id,
				balance,
				kwh_sum,
				update_date,
				remark
			FROM
				power_user
			INNER JOIN mapping_wechat_power ON power_user.id = mapping_wechat_power.power_id
			INNER JOIN wechat_user ON wechat_user.id = mapping_wechat_power.wechat_id
			WHERE
				wechat_user.id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
		
2024-07-22 11:46:37 执行sql 
			SELECT
				date,
				kwh,
				amount
			FROM
				power_day
			WHERE
				power_id = '6010921'
			ORDER BY
				date DESC
			LIMIT 30
		
2024-07-22 11:46:37 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'end',
					'2024-07-22 11:46:37',
					'{"list":[]}',
					'{"power_id":"6010921"}',
					'您近2天的电量电费消耗情况如下：
日期    电量    金额
07-21 22.27 16.7
07-20 20.94 15.71
'
				)

			
2024-07-22 11:46:37 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'end',
					'2024-07-22 11:46:37',
					'{"list":[]}',
					'{"power_id":"6010921"}',
					'您近2天的电量电费消耗情况如下：
日期    电量    金额
07-21 22.27 16.7
07-20 20.94 15.71
'
				)

			
2024-07-22 11:46:37 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 您近2天的电量电费消耗情况如下：
日期    电量    金额
07-21 22.27 16.7
07-20 20.94 15.71

2024-07-22 11:46:54 接收到POST请求
2024-07-22 11:46:54 http://weixin.xiayukun.asia:444/?signature=a622cb72173ce20f99a379a12987eb14295f60f4&timestamp=1721620014&nonce=2138806634&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 11:46:54 Query:{"signature":"a622cb72173ce20f99a379a12987eb14295f60f4","timestamp":"1721620014","nonce":"2138806634","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 11:46:54 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721620013"],"msgtype":["text"],"content":["1"],"msgid":["24647672037018018"]}}
2024-07-22 11:46:54 来文字消息了：1
2024-07-22 11:46:54 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 11:46:54',
						'24647672037018018',
						'1'
					)
		
2024-07-22 11:46:54 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 11:46:54 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 11:46:54 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 11:46:54',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 11:46:54 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 11:46:58 接收到POST请求
2024-07-22 11:46:58 http://weixin.xiayukun.asia:444/?signature=dd39bb0da5df05834301685e0b47c78ee07ed0a6&timestamp=1721620018&nonce=255221135&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 11:46:58 Query:{"signature":"dd39bb0da5df05834301685e0b47c78ee07ed0a6","timestamp":"1721620018","nonce":"255221135","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 11:46:58 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721620017"],"msgtype":["text"],"content":["1"],"msgid":["24647671428283960"]}}
2024-07-22 11:46:58 来文字消息了：1
2024-07-22 11:46:58 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 11:46:58',
						'24647671428283960',
						'1'
					)
		
2024-07-22 11:46:58 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 11:46:58 执行sql 
			SELECT
				power_user.id AS power_id,
				balance,
				kwh_sum,
				update_date,
				remark
			FROM
				power_user
			INNER JOIN mapping_wechat_power ON power_user.id = mapping_wechat_power.power_id
			INNER JOIN wechat_user ON wechat_user.id = mapping_wechat_power.wechat_id
			WHERE
				wechat_user.id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
		
2024-07-22 11:46:58 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'end',
					'2024-07-22 11:46:58',
					'{"list":[]}',
					'{}',
					'您绑定的电费账户余额如下：
6010921:
    余额：44.825
    底度：2689.92
    更新日期：2024-07-22
'
				)

			
2024-07-22 11:46:58 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 您绑定的电费账户余额如下：
6010921:
    余额：44.825
    底度：2689.92
    更新日期：2024-07-22

2024-07-22 11:47:07 接收到POST请求
2024-07-22 11:47:07 http://weixin.xiayukun.asia:444/?signature=25f7566560cb8e8de81eb1b6e9a98d6a78331cf1&timestamp=1721620026&nonce=2083821525&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 11:47:07 Query:{"signature":"25f7566560cb8e8de81eb1b6e9a98d6a78331cf1","timestamp":"1721620026","nonce":"2083821525","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 11:47:07 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721620026"],"msgtype":["text"],"content":["1"],"msgid":["24647671627090379"]}}
2024-07-22 11:47:07 来文字消息了：1
2024-07-22 11:47:07 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 11:47:07',
						'24647671627090379',
						'1'
					)
		
2024-07-22 11:47:07 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 11:47:07 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 11:47:07 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 11:47:07',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 11:47:07 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 11:47:32 接收到POST请求
2024-07-22 11:47:32 http://weixin.xiayukun.asia:444/?signature=cefae280200d53c423cc994070fcc4a7cb697bf4&timestamp=1721620052&nonce=1231255214&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 11:47:32 Query:{"signature":"cefae280200d53c423cc994070fcc4a7cb697bf4","timestamp":"1721620052","nonce":"1231255214","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 11:47:32 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721620052"],"msgtype":["text"],"content":["3"],"msgid":["24647670562592406"]}}
2024-07-22 11:47:32 来文字消息了：3
2024-07-22 11:47:32 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 11:47:32',
						'24647670562592406',
						'3'
					)
		
2024-07-22 11:47:32 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 11:47:32 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 3
			ORDER BY
				sort
			
2024-07-22 11:47:32 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'end',
					'2024-07-22 11:47:32',
					'{"list":[]}',
					'{}',
					'未找到菜单数据！请反馈管理员。'
				)

			
2024-07-22 11:47:32 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 未找到菜单数据！请反馈管理员。
2024-07-22 11:47:56 接收到POST请求
2024-07-22 11:47:56 http://weixin.xiayukun.asia:444/?signature=8227621543d1eb95d6fa46ad7857567e1fcf9f70&timestamp=1721620075&nonce=1825644044&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 11:47:56 Query:{"signature":"8227621543d1eb95d6fa46ad7857567e1fcf9f70","timestamp":"1721620075","nonce":"1825644044","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 11:47:56 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721620075"],"msgtype":["text"],"content":["4"],"msgid":["24647673686641071"]}}
2024-07-22 11:47:56 来文字消息了：4
2024-07-22 11:47:56 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 11:47:56',
						'24647673686641071',
						'4'
					)
		
2024-07-22 11:47:56 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 11:47:56 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 11:47:56 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 11:47:56',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 11:47:56 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 12:04:16 接收到POST请求
2024-07-22 12:04:16 http://weixin.xiayukun.asia:444/?signature=f9e9b084130a503239a72b77fa967e1235ce43e2&timestamp=1721621055&nonce=1818619736&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 12:04:16 Query:{"signature":"f9e9b084130a503239a72b77fa967e1235ce43e2","timestamp":"1721621055","nonce":"1818619736","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 12:04:16 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721621054"],"msgtype":["text"],"content":["3"],"msgid":["24647686725563541"]}}
2024-07-22 12:04:16 来文字消息了：3
2024-07-22 12:04:16 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 12:04:16',
						'24647686725563541',
						'3'
					)
		
2024-07-22 12:04:16 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:04:16 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 12:04:16 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 12:04:16',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 12:04:16 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 12:04:20 接收到POST请求
2024-07-22 12:04:20 http://weixin.xiayukun.asia:444/?signature=f8875a228a92828ac90e5bc71d06cf27983842ab&timestamp=1721621059&nonce=90667395&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 12:04:20 Query:{"signature":"f8875a228a92828ac90e5bc71d06cf27983842ab","timestamp":"1721621059","nonce":"90667395","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 12:04:20 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721621059"],"msgtype":["text"],"content":["3"],"msgid":["24647685424315778"]}}
2024-07-22 12:04:20 来文字消息了：3
2024-07-22 12:04:20 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 12:04:20',
						'24647685424315778',
						'3'
					)
		
2024-07-22 12:04:20 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:04:20 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 3
			ORDER BY
				sort
			
2024-07-22 12:04:20 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'end',
					'2024-07-22 12:04:20',
					'{"list":[]}',
					'{}',
					'未找到菜单数据！请反馈管理员。'
				)

			
2024-07-22 12:04:20 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 未找到菜单数据！请反馈管理员。
2024-07-22 12:04:27 接收到POST请求
2024-07-22 12:04:27 http://weixin.xiayukun.asia:444/?signature=66429d6427952ff894cd4a4cb2a8db23d8018ec5&timestamp=1721621067&nonce=1962603799&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 12:04:27 Query:{"signature":"66429d6427952ff894cd4a4cb2a8db23d8018ec5","timestamp":"1721621067","nonce":"1962603799","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 12:04:27 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721621066"],"msgtype":["text"],"content":["4"],"msgid":["24647683910463578"]}}
2024-07-22 12:04:27 来文字消息了：4
2024-07-22 12:04:27 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 12:04:27',
						'24647683910463578',
						'4'
					)
		
2024-07-22 12:04:27 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:04:27 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 12:04:27 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 12:04:27',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 12:04:27 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 12:04:31 接收到POST请求
2024-07-22 12:04:31 http://weixin.xiayukun.asia:444/?signature=f48b1f8559406ce1f58f6c71c59040d9c09b1638&timestamp=1721621070&nonce=937885256&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 12:04:31 Query:{"signature":"f48b1f8559406ce1f58f6c71c59040d9c09b1638","timestamp":"1721621070","nonce":"937885256","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 12:04:31 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721621070"],"msgtype":["text"],"content":["4"],"msgid":["24647684674186692"]}}
2024-07-22 12:04:31 来文字消息了：4
2024-07-22 12:04:31 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 12:04:31',
						'24647684674186692',
						'4'
					)
		
2024-07-22 12:04:31 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:04:31 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 4
			ORDER BY
				sort
			
2024-07-22 12:04:31 TypeError: methods[findActiveMenu.build_method] is not a function
    at sendMenu (file:///root/powerSearch/behind/wechat/menu.mjs:56:50)
    at processTicksAndRejections (node:internal/process/task_queues:96:5)
    at async event_text (file:///root/powerSearch/behind/wechat/event.mjs:50:19)
2024-07-22 12:04:41 接收到POST请求
2024-07-22 12:04:41 http://weixin.xiayukun.asia:444/?signature=034368b32c52f6a5407c51dfa4615637c0b3ce22&timestamp=1721621080&nonce=268336091&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 12:04:41 Query:{"signature":"034368b32c52f6a5407c51dfa4615637c0b3ce22","timestamp":"1721621080","nonce":"268336091","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 12:04:41 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721621080"],"msgtype":["text"],"content":["4"],"msgid":["24647683661587425"]}}
2024-07-22 12:04:41 来文字消息了：4
2024-07-22 12:04:41 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 12:04:41',
						'24647683661587425',
						'4'
					)
		
2024-07-22 12:04:41 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:04:41 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 4
			ORDER BY
				sort
			
2024-07-22 12:04:41 TypeError: methods[findActiveMenu.build_method] is not a function
    at sendMenu (file:///root/powerSearch/behind/wechat/menu.mjs:56:50)
    at processTicksAndRejections (node:internal/process/task_queues:96:5)
    at async event_text (file:///root/powerSearch/behind/wechat/event.mjs:50:19)
2024-07-22 12:04:46 接收到POST请求
2024-07-22 12:04:46 http://weixin.xiayukun.asia:444/?signature=797073877b381876e605f486470fd5558a0ec963&timestamp=1721621085&nonce=30671578&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 12:04:46 Query:{"signature":"797073877b381876e605f486470fd5558a0ec963","timestamp":"1721621085","nonce":"30671578","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 12:04:46 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721621085"],"msgtype":["text"],"content":["4"],"msgid":["24647684094020611"]}}
2024-07-22 12:04:46 来文字消息了：4
2024-07-22 12:04:46 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 12:04:46',
						'24647684094020611',
						'4'
					)
		
2024-07-22 12:04:46 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:04:46 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 4
			ORDER BY
				sort
			
2024-07-22 12:04:46 TypeError: methods[findActiveMenu.build_method] is not a function
    at sendMenu (file:///root/powerSearch/behind/wechat/menu.mjs:56:50)
    at processTicksAndRejections (node:internal/process/task_queues:96:5)
    at async event_text (file:///root/powerSearch/behind/wechat/event.mjs:50:19)
2024-07-22 12:04:52 接收到POST请求
2024-07-22 12:04:52 http://weixin.xiayukun.asia:444/?signature=9509ff5fa518a91ae68b282217fadd024145d4d4&timestamp=1721621091&nonce=996064163&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 12:04:52 Query:{"signature":"9509ff5fa518a91ae68b282217fadd024145d4d4","timestamp":"1721621091","nonce":"996064163","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 12:04:52 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721621091"],"msgtype":["text"],"content":["1"],"msgid":["24647687328257994"]}}
2024-07-22 12:04:52 来文字消息了：1
2024-07-22 12:04:52 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 12:04:52',
						'24647687328257994',
						'1'
					)
		
2024-07-22 12:04:52 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:04:52 执行sql 
			SELECT
				power_user.id AS power_id,
				balance,
				kwh_sum,
				update_date,
				remark
			FROM
				power_user
			INNER JOIN mapping_wechat_power ON power_user.id = mapping_wechat_power.power_id
			INNER JOIN wechat_user ON wechat_user.id = mapping_wechat_power.wechat_id
			WHERE
				wechat_user.id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
		
2024-07-22 12:04:52 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'end',
					'2024-07-22 12:04:52',
					'{"list":[]}',
					'{}',
					'您绑定的电费账户余额如下：
6010921:
    余额：44.825
    底度：2689.92
    更新日期：2024-07-22
'
				)

			
2024-07-22 12:04:52 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 您绑定的电费账户余额如下：
6010921:
    余额：44.825
    底度：2689.92
    更新日期：2024-07-22

2024-07-22 12:05:02 接收到POST请求
2024-07-22 12:05:02 http://weixin.xiayukun.asia:444/?signature=6addce6bf71ccff09f477de13ee036a915d90204&timestamp=1721621101&nonce=728553818&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 12:05:02 Query:{"signature":"6addce6bf71ccff09f477de13ee036a915d90204","timestamp":"1721621101","nonce":"728553818","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 12:05:02 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721621101"],"msgtype":["text"],"content":["1"],"msgid":["24647690471166624"]}}
2024-07-22 12:05:02 来文字消息了：1
2024-07-22 12:05:02 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 12:05:02',
						'24647690471166624',
						'1'
					)
		
2024-07-22 12:05:02 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:05:02 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 12:05:02 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 12:05:02',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 12:05:02 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 12:05:08 接收到POST请求
2024-07-22 12:05:08 http://weixin.xiayukun.asia:444/?signature=4e9fe37a34cf53ac3c59b7314a31654464eff46b&timestamp=1721621108&nonce=851311012&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 12:05:08 Query:{"signature":"4e9fe37a34cf53ac3c59b7314a31654464eff46b","timestamp":"1721621108","nonce":"851311012","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 12:05:08 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721621108"],"msgtype":["text"],"content":["0"],"msgid":["24647689623239515"]}}
2024-07-22 12:05:08 来文字消息了：0
2024-07-22 12:05:08 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 12:05:08',
						'24647689623239515',
						'0'
					)
		
2024-07-22 12:05:08 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:05:08 TypeError: methods[matchObj.click_method] is not a function
    at sendMenu (file:///root/powerSearch/behind/wechat/menu.mjs:45:72)
    at processTicksAndRejections (node:internal/process/task_queues:96:5)
    at async event_text (file:///root/powerSearch/behind/wechat/event.mjs:50:19)
2024-07-22 12:05:15 接收到POST请求
2024-07-22 12:05:15 http://weixin.xiayukun.asia:444/?signature=3a31b8dade5177177b3e52e786577c2160711969&timestamp=1721621114&nonce=841350233&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 12:05:15 Query:{"signature":"3a31b8dade5177177b3e52e786577c2160711969","timestamp":"1721621114","nonce":"841350233","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 12:05:15 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721621114"],"msgtype":["text"],"content":["1"],"msgid":["24647690282871763"]}}
2024-07-22 12:05:15 来文字消息了：1
2024-07-22 12:05:15 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 12:05:15',
						'24647690282871763',
						'1'
					)
		
2024-07-22 12:05:15 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:05:15 执行sql 
			SELECT
				power_user.id AS power_id,
				balance,
				kwh_sum,
				update_date,
				remark
			FROM
				power_user
			INNER JOIN mapping_wechat_power ON power_user.id = mapping_wechat_power.power_id
			INNER JOIN wechat_user ON wechat_user.id = mapping_wechat_power.wechat_id
			WHERE
				wechat_user.id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
		
2024-07-22 12:05:15 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'end',
					'2024-07-22 12:05:15',
					'{"list":[]}',
					'{}',
					'您绑定的电费账户余额如下：
6010921:
    余额：44.825
    底度：2689.92
    更新日期：2024-07-22
'
				)

			
2024-07-22 12:05:15 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 您绑定的电费账户余额如下：
6010921:
    余额：44.825
    底度：2689.92
    更新日期：2024-07-22

2024-07-22 12:05:19 接收到POST请求
2024-07-22 12:05:19 http://weixin.xiayukun.asia:444/?signature=7817b8f023fb086444b94c1e687321236857b1cb&timestamp=1721621118&nonce=1131403307&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 12:05:19 Query:{"signature":"7817b8f023fb086444b94c1e687321236857b1cb","timestamp":"1721621118","nonce":"1131403307","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 12:05:19 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721621118"],"msgtype":["text"],"content":["1"],"msgid":["24647689241860816"]}}
2024-07-22 12:05:19 来文字消息了：1
2024-07-22 12:05:19 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 12:05:19',
						'24647689241860816',
						'1'
					)
		
2024-07-22 12:05:19 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:05:19 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 12:05:19 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 12:05:19',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 12:05:19 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 12:18:58 接收到POST请求
2024-07-22 12:18:58 http://weixin.xiayukun.asia:444/?signature=3b61ff5bf2c9575c3cc7b85ad5cd70ddb58f735a&timestamp=1721621936&nonce=2060786450&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 12:18:58 Query:{"signature":"3b61ff5bf2c9575c3cc7b85ad5cd70ddb58f735a","timestamp":"1721621936","nonce":"2060786450","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 12:18:58 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721621936"],"msgtype":["text"],"content":["1"],"msgid":["24647697516039059"]}}
2024-07-22 12:18:58 来文字消息了：1
2024-07-22 12:18:58 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 12:18:58',
						'24647697516039059',
						'1'
					)
		
2024-07-22 12:18:58 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:18:58 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 12:18:58 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 12:18:58',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 12:18:58 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 12:19:01 接收到POST请求
2024-07-22 12:19:01 http://weixin.xiayukun.asia:444/?signature=2c9b694bf3797f4e1129d92c4086070dd7961f13&timestamp=1721621941&nonce=1951315154&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 12:19:01 Query:{"signature":"2c9b694bf3797f4e1129d92c4086070dd7961f13","timestamp":"1721621941","nonce":"1951315154","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 12:19:01 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721621940"],"msgtype":["text"],"content":["1"],"msgid":["24647697875639510"]}}
2024-07-22 12:19:01 来文字消息了：1
2024-07-22 12:19:01 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 12:19:01',
						'24647697875639510',
						'1'
					)
		
2024-07-22 12:19:01 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:19:01 执行sql 
			SELECT
				power_user.id AS power_id,
				balance,
				kwh_sum,
				update_date,
				remark
			FROM
				power_user
			INNER JOIN mapping_wechat_power ON power_user.id = mapping_wechat_power.power_id
			INNER JOIN wechat_user ON wechat_user.id = mapping_wechat_power.wechat_id
			WHERE
				wechat_user.id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
		
2024-07-22 12:19:01 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'end',
					'2024-07-22 12:19:01',
					'{"list":[]}',
					'{}',
					'您绑定的电费账户余额如下：
6010921:
    余额：44.825
    底度：2689.92
    更新日期：2024-07-22
'
				)

			
2024-07-22 12:19:01 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 您绑定的电费账户余额如下：
6010921:
    余额：44.825
    底度：2689.92
    更新日期：2024-07-22

2024-07-22 12:19:05 接收到POST请求
2024-07-22 12:19:05 http://weixin.xiayukun.asia:444/?signature=674563636fa60ecd357e077ce07b880b608e0c3c&timestamp=1721621944&nonce=289855458&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 12:19:05 Query:{"signature":"674563636fa60ecd357e077ce07b880b608e0c3c","timestamp":"1721621944","nonce":"289855458","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 12:19:05 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721621944"],"msgtype":["text"],"content":["2"],"msgid":["24647696827346817"]}}
2024-07-22 12:19:05 来文字消息了：2
2024-07-22 12:19:05 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 12:19:05',
						'24647696827346817',
						'2'
					)
		
2024-07-22 12:19:05 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:19:05 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 12:19:05 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 12:19:05',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 12:19:05 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 12:19:08 接收到POST请求
2024-07-22 12:19:08 http://weixin.xiayukun.asia:444/?signature=859e343c30da553f63917793fcefc655a19031b3&timestamp=1721621948&nonce=899482569&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 12:19:08 Query:{"signature":"859e343c30da553f63917793fcefc655a19031b3","timestamp":"1721621948","nonce":"899482569","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 12:19:08 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721621947"],"msgtype":["text"],"content":["2"],"msgid":["24647697326625838"]}}
2024-07-22 12:19:08 来文字消息了：2
2024-07-22 12:19:08 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 12:19:08',
						'24647697326625838',
						'2'
					)
		
2024-07-22 12:19:08 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:19:08 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 2
			ORDER BY
				sort
			
2024-07-22 12:19:08 执行sql 
			SELECT
				power_user.id AS power_id,
				balance,
				kwh_sum,
				update_date,
				remark
			FROM
				power_user
			INNER JOIN mapping_wechat_power ON power_user.id = mapping_wechat_power.power_id
			INNER JOIN wechat_user ON wechat_user.id = mapping_wechat_power.wechat_id
			WHERE
				wechat_user.id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
		
2024-07-22 12:19:08 执行sql 
			SELECT
				date,
				kwh,
				amount
			FROM
				power_day
			WHERE
				power_id = '6010921'
			ORDER BY
				date DESC
			LIMIT 30
		
2024-07-22 12:19:08 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'end',
					'2024-07-22 12:19:08',
					'{"list":[]}',
					'{"power_id":"6010921"}',
					'您近2天的电量电费消耗情况如下：
日期    电量    金额
07-21 22.27 16.7
07-20 20.94 15.71
'
				)

			
2024-07-22 12:19:08 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'end',
					'2024-07-22 12:19:08',
					'{"list":[]}',
					'{"power_id":"6010921"}',
					'您近2天的电量电费消耗情况如下：
日期    电量    金额
07-21 22.27 16.7
07-20 20.94 15.71
'
				)

			
2024-07-22 12:19:08 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 您近2天的电量电费消耗情况如下：
日期    电量    金额
07-21 22.27 16.7
07-20 20.94 15.71

2024-07-22 12:19:09 接收到POST请求
2024-07-22 12:19:09 http://weixin.xiayukun.asia:444/api/check-wechat
2024-07-22 12:19:09 Query:{}
2024-07-22 12:19:09 Body:{"wechat_id":"oTYqx6d_R7Cm1LExDz8aMvJi-5AA"}
2024-07-22 12:19:09 执行sql 
			SELECT
				*
			FROM
				wechat_user
			WHERE
				id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
			
2024-07-22 12:19:16 接收到POST请求
2024-07-22 12:19:16 http://weixin.xiayukun.asia:444/api/bind
2024-07-22 12:19:16 Query:{}
2024-07-22 12:19:16 Body:{"username":"6010921","password":"7108","wechat_id":"oTYqx6d_R7Cm1LExDz8aMvJi-5AA","remark":""}
2024-07-22 12:19:16 执行sql 
			SELECT
				*
			FROM
				wechat_user
			WHERE
				id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
			
2024-07-22 12:19:16 执行sql 
			SELECT
				wechat_user.id
			FROM
				wechat_user
			INNER JOIN mapping_wechat_power ON wechat_user.id = mapping_wechat_power.wechat_id
			INNER JOIN power_user ON power_user.id = mapping_wechat_power.power_id
			WHERE
				power_user.id = '6010921'
		
2024-07-22 12:19:16 执行sql 
			INSERT INTO mapping_wechat_power (wechat_id, power_id)
			VALUES
				('oTYqx6d_R7Cm1LExDz8aMvJi-5AA', '6010921');
		
2024-07-22 12:19:45 接收到POST请求
2024-07-22 12:19:45 http://weixin.xiayukun.asia:444/?signature=2ab40331f00feda768842302297769268cd091cc&timestamp=1721621985&nonce=999717513&openid=oTYqx6d_R7Cm1LExDz8aMvJi-5AA
2024-07-22 12:19:45 Query:{"signature":"2ab40331f00feda768842302297769268cd091cc","timestamp":"1721621985","nonce":"999717513","openid":"oTYqx6d_R7Cm1LExDz8aMvJi-5AA"}
2024-07-22 12:19:45 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6d_R7Cm1LExDz8aMvJi-5AA"],"createtime":["1721621985"],"msgtype":["event"],"event":["unsubscribe"],"eventkey":[""]}}
2024-07-22 12:19:45 有人取消关注了：oTYqx6d_R7Cm1LExDz8aMvJi-5AA
2024-07-22 12:19:45 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
						'unsubscribe',
						'2024-07-22 12:19:45',
						null,
						null
					)
		
2024-07-22 12:19:45 执行sql  
			SELECT
				power_id,
				count(1) as count
			FROM
				mapping_wechat_power
			WHERE
				power_id IN (
					SELECT
						power_id
					FROM
						mapping_wechat_power
					WHERE
						wechat_id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
				)
			GROUP BY
				power_id
			
2024-07-22 12:19:45 执行sql 
			DELETE
			FROM
				mapping_wechat_power
			WHERE
				wechat_id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
			
2024-07-22 12:19:45 执行sql 
			DELETE
			FROM
				wechat_user
			WHERE
				id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
			
2024-07-22 12:19:48 接收到POST请求
2024-07-22 12:19:48 http://weixin.xiayukun.asia:444/?signature=463acb32a36e945ffb8b8e106368711f8cb8ca33&timestamp=1721621988&nonce=1369069635&openid=oTYqx6d_R7Cm1LExDz8aMvJi-5AA
2024-07-22 12:19:48 Query:{"signature":"463acb32a36e945ffb8b8e106368711f8cb8ca33","timestamp":"1721621988","nonce":"1369069635","openid":"oTYqx6d_R7Cm1LExDz8aMvJi-5AA"}
2024-07-22 12:19:48 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6d_R7Cm1LExDz8aMvJi-5AA"],"createtime":["1721621988"],"msgtype":["event"],"event":["subscribe"],"eventkey":[""]}}
2024-07-22 12:19:48 有人关注了：oTYqx6d_R7Cm1LExDz8aMvJi-5AA
2024-07-22 12:19:48 执行sql 
			INSERT INTO wechat_user (id, create_datetime)
			VALUES
				('oTYqx6d_R7Cm1LExDz8aMvJi-5AA', '2024-07-22 12:19:48')
			ON DUPLICATE KEY UPDATE create_datetime='2024-07-22 12:19:48';
		
2024-07-22 12:19:48 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
						'subscribe',
						'2024-07-22 12:19:48',
						null,
						null
					)
		
2024-07-22 12:19:48 向oTYqx6d_R7Cm1LExDz8aMvJi-5AA发送信息：
 	朗悦公寓交电费用法过于麻烦，并且不会没电费提醒，所以特此做个提醒功能，方便自己，如有侵权，联系我马上删除。
	请点击以下链接进行电费账户绑定并进行提醒设置：
https://mp.xiayukun.asia/bind/index.html?n=oTYqx6d_R7Cm1LExDz8aMvJi-5AA
或者请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
2024-07-22 12:19:53 接收到POST请求
2024-07-22 12:19:53 http://weixin.xiayukun.asia:444/api/check-wechat
2024-07-22 12:19:53 Query:{}
2024-07-22 12:19:53 Body:{"wechat_id":"oTYqx6d_R7Cm1LExDz8aMvJi-5AA"}
2024-07-22 12:19:53 执行sql 
			SELECT
				*
			FROM
				wechat_user
			WHERE
				id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
			
2024-07-22 12:20:00 接收到POST请求
2024-07-22 12:20:00 http://weixin.xiayukun.asia:444/api/bind
2024-07-22 12:20:00 Query:{}
2024-07-22 12:20:00 Body:{"username":"6010921","password":"7108","wechat_id":"oTYqx6d_R7Cm1LExDz8aMvJi-5AA","remark":""}
2024-07-22 12:20:00 执行sql 
			SELECT
				*
			FROM
				wechat_user
			WHERE
				id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
			
2024-07-22 12:20:00 执行sql 
			SELECT
				wechat_user.id
			FROM
				wechat_user
			INNER JOIN mapping_wechat_power ON wechat_user.id = mapping_wechat_power.wechat_id
			INNER JOIN power_user ON power_user.id = mapping_wechat_power.power_id
			WHERE
				power_user.id = '6010921'
		
2024-07-22 12:20:00 执行sql 
			INSERT INTO mapping_wechat_power (wechat_id, power_id)
			VALUES
				('oTYqx6d_R7Cm1LExDz8aMvJi-5AA', '6010921');
		
2024-07-22 12:20:09 接收到POST请求
2024-07-22 12:20:09 http://weixin.xiayukun.asia:444/?signature=38aaee83d9c65d92fc264089f245ed6b324ce7a6&timestamp=1721622008&nonce=885530135&openid=oTYqx6d_R7Cm1LExDz8aMvJi-5AA
2024-07-22 12:20:09 Query:{"signature":"38aaee83d9c65d92fc264089f245ed6b324ce7a6","timestamp":"1721622008","nonce":"885530135","openid":"oTYqx6d_R7Cm1LExDz8aMvJi-5AA"}
2024-07-22 12:20:09 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6d_R7Cm1LExDz8aMvJi-5AA"],"createtime":["1721622008"],"msgtype":["text"],"content":["1"],"msgid":["24647700742063795"]}}
2024-07-22 12:20:09 来文字消息了：1
2024-07-22 12:20:09 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
						'text',
						'2024-07-22 12:20:09',
						'24647700742063795',
						'1'
					)
		
2024-07-22 12:20:09 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:20:09 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 12:20:09 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
					'menu',
					'2024-07-22 12:20:09',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 12:20:09 向oTYqx6d_R7Cm1LExDz8aMvJi-5AA发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 12:20:14 接收到POST请求
2024-07-22 12:20:14 http://weixin.xiayukun.asia:444/?signature=11c3082b41818fed0dc920ae1da0f7803a1bb627&timestamp=1721622013&nonce=749946447&openid=oTYqx6d_R7Cm1LExDz8aMvJi-5AA
2024-07-22 12:20:14 Query:{"signature":"11c3082b41818fed0dc920ae1da0f7803a1bb627","timestamp":"1721622013","nonce":"749946447","openid":"oTYqx6d_R7Cm1LExDz8aMvJi-5AA"}
2024-07-22 12:20:14 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6d_R7Cm1LExDz8aMvJi-5AA"],"createtime":["1721622013"],"msgtype":["text"],"content":["1"],"msgid":["24647701224865818"]}}
2024-07-22 12:20:14 来文字消息了：1
2024-07-22 12:20:14 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
						'text',
						'2024-07-22 12:20:14',
						'24647701224865818',
						'1'
					)
		
2024-07-22 12:20:14 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:20:14 执行sql 
			SELECT
				power_user.id AS power_id,
				balance,
				kwh_sum,
				update_date,
				remark
			FROM
				power_user
			INNER JOIN mapping_wechat_power ON power_user.id = mapping_wechat_power.power_id
			INNER JOIN wechat_user ON wechat_user.id = mapping_wechat_power.wechat_id
			WHERE
				wechat_user.id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
		
2024-07-22 12:20:14 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
					'end',
					'2024-07-22 12:20:14',
					'{"list":[]}',
					'{}',
					'您绑定的电费账户余额如下：
6010921:
    余额：44.825
    底度：2689.92
    更新日期：2024-07-22
'
				)

			
2024-07-22 12:20:14 向oTYqx6d_R7Cm1LExDz8aMvJi-5AA发送信息：
 您绑定的电费账户余额如下：
6010921:
    余额：44.825
    底度：2689.92
    更新日期：2024-07-22

2024-07-22 12:20:20 接收到POST请求
2024-07-22 12:20:20 http://weixin.xiayukun.asia:444/?signature=4f65453f2b0943b385a812115d1bc7082a7f8e1c&timestamp=1721622020&nonce=1127382978&openid=oTYqx6d_R7Cm1LExDz8aMvJi-5AA
2024-07-22 12:20:20 Query:{"signature":"4f65453f2b0943b385a812115d1bc7082a7f8e1c","timestamp":"1721622020","nonce":"1127382978","openid":"oTYqx6d_R7Cm1LExDz8aMvJi-5AA"}
2024-07-22 12:20:20 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6d_R7Cm1LExDz8aMvJi-5AA"],"createtime":["1721622019"],"msgtype":["text"],"content":["2"],"msgid":["24647703496016101"]}}
2024-07-22 12:20:20 来文字消息了：2
2024-07-22 12:20:20 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
						'text',
						'2024-07-22 12:20:20',
						'24647703496016101',
						'2'
					)
		
2024-07-22 12:20:20 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:20:20 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 12:20:20 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
					'menu',
					'2024-07-22 12:20:20',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 12:20:20 向oTYqx6d_R7Cm1LExDz8aMvJi-5AA发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 12:20:27 接收到POST请求
2024-07-22 12:20:27 http://weixin.xiayukun.asia:444/?signature=8ad136317bc4714e9e00b241c05ef7b0c6e97999&timestamp=1721622026&nonce=985491235&openid=oTYqx6d_R7Cm1LExDz8aMvJi-5AA
2024-07-22 12:20:27 Query:{"signature":"8ad136317bc4714e9e00b241c05ef7b0c6e97999","timestamp":"1721622026","nonce":"985491235","openid":"oTYqx6d_R7Cm1LExDz8aMvJi-5AA"}
2024-07-22 12:20:27 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6d_R7Cm1LExDz8aMvJi-5AA"],"createtime":["1721622026"],"msgtype":["text"],"content":["2"],"msgid":["24647703864650174"]}}
2024-07-22 12:20:27 来文字消息了：2
2024-07-22 12:20:27 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
						'text',
						'2024-07-22 12:20:27',
						'24647703864650174',
						'2'
					)
		
2024-07-22 12:20:27 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 12:20:27 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 2
			ORDER BY
				sort
			
2024-07-22 12:20:27 执行sql 
			SELECT
				power_user.id AS power_id,
				balance,
				kwh_sum,
				update_date,
				remark
			FROM
				power_user
			INNER JOIN mapping_wechat_power ON power_user.id = mapping_wechat_power.power_id
			INNER JOIN wechat_user ON wechat_user.id = mapping_wechat_power.wechat_id
			WHERE
				wechat_user.id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
		
2024-07-22 12:20:27 执行sql 
			SELECT
				date,
				kwh,
				amount
			FROM
				power_day
			WHERE
				power_id = '6010921'
			ORDER BY
				date DESC
			LIMIT 30
		
2024-07-22 12:20:27 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
					'end',
					'2024-07-22 12:20:27',
					'{"list":[]}',
					'{"power_id":"6010921"}',
					'您近2天的电量电费消耗情况如下：
日期    电量    金额
07-21 22.27 16.7
07-20 20.94 15.71
'
				)

			
2024-07-22 12:20:27 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
					'end',
					'2024-07-22 12:20:27',
					'{"list":[]}',
					'{"power_id":"6010921"}',
					'您近2天的电量电费消耗情况如下：
日期    电量    金额
07-21 22.27 16.7
07-20 20.94 15.71
'
				)

			
2024-07-22 12:20:27 向oTYqx6d_R7Cm1LExDz8aMvJi-5AA发送信息：
 您近2天的电量电费消耗情况如下：
日期    电量    金额
07-21 22.27 16.7
07-20 20.94 15.71

2024-07-22 16:50:43 接收到POST请求
2024-07-22 16:50:43 http://weixin.xiayukun.asia:444/api/check-wechat
2024-07-22 16:50:43 Query:{}
2024-07-22 16:50:43 Body:{"wechat_id":"oTYqx6d_R7Cm1LExDz8aMvJi-5AA"}
2024-07-22 16:50:43 执行sql 
			SELECT
				*
			FROM
				wechat_user
			WHERE
				id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
			
2024-07-22 18:46:10 接收到POST请求
2024-07-22 18:46:10 http://weixin.xiayukun.asia:444/?signature=64dba6e67d289ef560c27542b5ed14cf6593f0fc&timestamp=1721645169&nonce=738570086&openid=oTYqx6d_R7Cm1LExDz8aMvJi-5AA
2024-07-22 18:46:10 Query:{"signature":"64dba6e67d289ef560c27542b5ed14cf6593f0fc","timestamp":"1721645169","nonce":"738570086","openid":"oTYqx6d_R7Cm1LExDz8aMvJi-5AA"}
2024-07-22 18:46:10 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6d_R7Cm1LExDz8aMvJi-5AA"],"createtime":["1721645169"],"msgtype":["text"],"content":["1"],"msgid":["24648033373962060"]}}
2024-07-22 18:46:10 来文字消息了：1
2024-07-22 18:46:10 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
						'text',
						'2024-07-22 18:46:10',
						'24648033373962060',
						'1'
					)
		
2024-07-22 18:46:10 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 18:46:10 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 18:46:10 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
					'menu',
					'2024-07-22 18:46:10',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 18:46:10 向oTYqx6d_R7Cm1LExDz8aMvJi-5AA发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 18:46:19 接收到POST请求
2024-07-22 18:46:19 http://weixin.xiayukun.asia:444/?signature=a1c8bc2ec3b601df8299aee1df3ba5396009af6b&timestamp=1721645178&nonce=918024714&openid=oTYqx6d_R7Cm1LExDz8aMvJi-5AA
2024-07-22 18:46:19 Query:{"signature":"a1c8bc2ec3b601df8299aee1df3ba5396009af6b","timestamp":"1721645178","nonce":"918024714","openid":"oTYqx6d_R7Cm1LExDz8aMvJi-5AA"}
2024-07-22 18:46:19 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6d_R7Cm1LExDz8aMvJi-5AA"],"createtime":["1721645178"],"msgtype":["text"],"content":["1"],"msgid":["24648035419793549"]}}
2024-07-22 18:46:19 来文字消息了：1
2024-07-22 18:46:19 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
						'text',
						'2024-07-22 18:46:19',
						'24648035419793549',
						'1'
					)
		
2024-07-22 18:46:19 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 18:46:19 执行sql 
			SELECT
				power_user.id AS power_id,
				balance,
				kwh_sum,
				update_date,
				remark
			FROM
				power_user
			INNER JOIN mapping_wechat_power ON power_user.id = mapping_wechat_power.power_id
			INNER JOIN wechat_user ON wechat_user.id = mapping_wechat_power.wechat_id
			WHERE
				wechat_user.id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
		
2024-07-22 18:46:19 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
					'end',
					'2024-07-22 18:46:19',
					'{"list":[]}',
					'{}',
					'您绑定的电费账户余额如下：
6010921:
    余额：44.825
    底度：2689.92
    更新日期：2024-07-22
'
				)

			
2024-07-22 18:46:19 向oTYqx6d_R7Cm1LExDz8aMvJi-5AA发送信息：
 您绑定的电费账户余额如下：
6010921:
    余额：44.825
    底度：2689.92
    更新日期：2024-07-22

2024-07-22 18:46:25 接收到POST请求
2024-07-22 18:46:25 http://weixin.xiayukun.asia:444/?signature=5862575b092f304d21e585cb7b25e813b1d6ad04&timestamp=1721645185&nonce=1926282334&openid=oTYqx6d_R7Cm1LExDz8aMvJi-5AA
2024-07-22 18:46:25 Query:{"signature":"5862575b092f304d21e585cb7b25e813b1d6ad04","timestamp":"1721645185","nonce":"1926282334","openid":"oTYqx6d_R7Cm1LExDz8aMvJi-5AA"}
2024-07-22 18:46:25 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6d_R7Cm1LExDz8aMvJi-5AA"],"createtime":["1721645184"],"msgtype":["text"],"content":["2"],"msgid":["24648034302165718"]}}
2024-07-22 18:46:25 来文字消息了：2
2024-07-22 18:46:25 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
						'text',
						'2024-07-22 18:46:25',
						'24648034302165718',
						'2'
					)
		
2024-07-22 18:46:25 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6d_R7Cm1LExDz8aMvJi-5AA'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 18:46:25 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 18:46:25 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6d_R7Cm1LExDz8aMvJi-5AA',
					'menu',
					'2024-07-22 18:46:25',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 18:46:25 向oTYqx6d_R7Cm1LExDz8aMvJi-5AA发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 18:51:30 接收到POST请求
2024-07-22 18:51:30 http://weixin.xiayukun.asia:444/?signature=0c84f8e7ae38e5ab31d99485d171a6de09e84e3d&timestamp=1721645489&nonce=332205816&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 18:51:30 Query:{"signature":"0c84f8e7ae38e5ab31d99485d171a6de09e84e3d","timestamp":"1721645489","nonce":"332205816","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 18:51:30 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721645489"],"msgtype":["text"],"content":["3"],"msgid":["24648038681111422"]}}
2024-07-22 18:51:30 来文字消息了：3
2024-07-22 18:51:30 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 18:51:30',
						'24648038681111422',
						'3'
					)
		
2024-07-22 18:51:30 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 18:51:30 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 18:51:30 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 18:51:30',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 18:51:30 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 18:51:36 接收到POST请求
2024-07-22 18:51:36 http://weixin.xiayukun.asia:444/?signature=5a27d12f46952df165f8da46a2b658e6137936ac&timestamp=1721645495&nonce=611005647&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 18:51:36 Query:{"signature":"5a27d12f46952df165f8da46a2b658e6137936ac","timestamp":"1721645495","nonce":"611005647","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 18:51:36 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721645495"],"msgtype":["text"],"content":["3"],"msgid":["24648038453255527"]}}
2024-07-22 18:51:36 来文字消息了：3
2024-07-22 18:51:36 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 18:51:36',
						'24648038453255527',
						'3'
					)
		
2024-07-22 18:51:36 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 18:51:36 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 3
			ORDER BY
				sort
			
2024-07-22 18:51:36 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'end',
					'2024-07-22 18:51:36',
					'{"list":[]}',
					'{}',
					'未找到菜单数据！请反馈管理员。'
				)

			
2024-07-22 18:51:36 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 未找到菜单数据！请反馈管理员。
2024-07-22 18:52:07 接收到POST请求
2024-07-22 18:52:07 http://weixin.xiayukun.asia:444/?signature=e63572346f06f3bde726ab2ea5df83a435a3c065&timestamp=1721645527&nonce=849736504&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 18:52:07 Query:{"signature":"e63572346f06f3bde726ab2ea5df83a435a3c065","timestamp":"1721645527","nonce":"849736504","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 18:52:07 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721645526"],"msgtype":["text"],"content":["4"],"msgid":["24648039843316049"]}}
2024-07-22 18:52:07 来文字消息了：4
2024-07-22 18:52:07 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 18:52:07',
						'24648039843316049',
						'4'
					)
		
2024-07-22 18:52:07 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 18:52:07 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 18:52:07 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 18:52:07',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 18:52:07 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 18:52:30 接收到POST请求
2024-07-22 18:52:30 http://weixin.xiayukun.asia:444/?signature=3f6b094f8155f016c4f7445d8b41e77d74a1cc38&timestamp=1721645549&nonce=1611012469&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 18:52:30 Query:{"signature":"3f6b094f8155f016c4f7445d8b41e77d74a1cc38","timestamp":"1721645549","nonce":"1611012469","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 18:52:30 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721645549"],"msgtype":["text"],"content":["4"],"msgid":["24648038970825923"]}}
2024-07-22 18:52:30 来文字消息了：4
2024-07-22 18:52:30 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 18:52:30',
						'24648038970825923',
						'4'
					)
		
2024-07-22 18:52:30 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 18:52:30 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 4
			ORDER BY
				sort
			
2024-07-22 18:52:30 TypeError: methods[findActiveMenu.build_method] is not a function
    at sendMenu (file:///root/powerSearch/behind/wechat/menu.mjs:56:50)
    at processTicksAndRejections (node:internal/process/task_queues:96:5)
    at async event_text (file:///root/powerSearch/behind/wechat/event.mjs:50:19)
2024-07-22 18:57:38 接收到POST请求
2024-07-22 18:57:38 http://weixin.xiayukun.asia:444/?signature=d2f8557e48094867257c1b4064d8812f3470f38a&timestamp=1721645857&nonce=1412792236&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 18:57:38 Query:{"signature":"d2f8557e48094867257c1b4064d8812f3470f38a","timestamp":"1721645857","nonce":"1412792236","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 18:57:38 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721645857"],"msgtype":["text"],"content":["4"],"msgid":["24648040833857730"]}}
2024-07-22 18:57:38 来文字消息了：4
2024-07-22 18:57:38 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 18:57:38',
						'24648040833857730',
						'4'
					)
		
2024-07-22 18:57:38 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 18:57:38 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 18:57:38 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 18:57:38',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 18:57:38 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 18:57:42 接收到POST请求
2024-07-22 18:57:42 http://weixin.xiayukun.asia:444/?signature=c5200d4fc6da62312504baed0518cebea5d7ac65&timestamp=1721645861&nonce=1569438393&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 18:57:42 Query:{"signature":"c5200d4fc6da62312504baed0518cebea5d7ac65","timestamp":"1721645861","nonce":"1569438393","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 18:57:42 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721645861"],"msgtype":["text"],"content":["4"],"msgid":["24648040221416136"]}}
2024-07-22 18:57:42 来文字消息了：4
2024-07-22 18:57:42 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 18:57:42',
						'24648040221416136',
						'4'
					)
		
2024-07-22 18:57:42 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 18:57:42 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 4
			ORDER BY
				sort
			
2024-07-22 18:57:42 执行sql 
			SELECT
				power_user.id AS power_id,
				balance,
				kwh_sum,
				update_date,
				remark
			FROM
				power_user
			INNER JOIN mapping_wechat_power ON power_user.id = mapping_wechat_power.power_id
			INNER JOIN wechat_user ON wechat_user.id = mapping_wechat_power.wechat_id
			WHERE
				wechat_user.id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
		
2024-07-22 18:57:42 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 7
			ORDER BY
				sort
			
2024-07-22 18:57:42 TypeError: methods[findActiveMenu.build_method] is not a function
    at sendMenu (file:///root/powerSearch/behind/wechat/menu.mjs:56:50)
    at processTicksAndRejections (node:internal/process/task_queues:96:5)
    at async Object.methods.build_power (file:///root/powerSearch/behind/wechat/menu.mjs:81:26)
    at async sendMenu (file:///root/powerSearch/behind/wechat/menu.mjs:56:8)
    at async event_text (file:///root/powerSearch/behind/wechat/event.mjs:50:19)
2024-07-22 18:58:46 接收到POST请求
2024-07-22 18:58:46 http://weixin.xiayukun.asia:444/?signature=e560adfa59600961d71e1f1f11df1afeeb3992e5&timestamp=1721645925&nonce=1611516120&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 18:58:46 Query:{"signature":"e560adfa59600961d71e1f1f11df1afeeb3992e5","timestamp":"1721645925","nonce":"1611516120","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 18:58:46 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721645925"],"msgtype":["text"],"content":["4"],"msgid":["24648040758510511"]}}
2024-07-22 18:58:46 来文字消息了：4
2024-07-22 18:58:46 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 18:58:46',
						'24648040758510511',
						'4'
					)
		
2024-07-22 18:58:46 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 18:58:46 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 4
			ORDER BY
				sort
			
2024-07-22 18:58:46 执行sql 
			SELECT
				power_user.id AS power_id,
				balance,
				kwh_sum,
				update_date,
				remark
			FROM
				power_user
			INNER JOIN mapping_wechat_power ON power_user.id = mapping_wechat_power.power_id
			INNER JOIN wechat_user ON wechat_user.id = mapping_wechat_power.wechat_id
			WHERE
				wechat_user.id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
		
2024-07-22 18:58:46 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 7
			ORDER BY
				sort
			
2024-07-22 18:58:46 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 18:58:46',
					'{"list":[]}',
					'{"power_id":"6010921"}',
					'请输入以下回复(5分钟有效)：
'
				)

			
2024-07-22 18:58:46 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 18:58:46',
					'{"list":[]}',
					'{"power_id":"6010921"}',
					'请输入以下回复(5分钟有效)：
'
				)

			
2024-07-22 18:58:46 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 请输入以下回复(5分钟有效)：

2024-07-22 18:58:49 接收到POST请求
2024-07-22 18:58:49 http://weixin.xiayukun.asia:444/?signature=310aeb33eb0d775f6161759c5f9791ec6a9d9fb6&timestamp=1721645929&nonce=1414167614&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 18:58:49 Query:{"signature":"310aeb33eb0d775f6161759c5f9791ec6a9d9fb6","timestamp":"1721645929","nonce":"1414167614","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 18:58:49 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721645929"],"msgtype":["text"],"content":["4"],"msgid":["24648043380340153"]}}
2024-07-22 18:58:49 来文字消息了：4
2024-07-22 18:58:49 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 18:58:49',
						'24648043380340153',
						'4'
					)
		
2024-07-22 18:58:49 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 18:58:49 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'end',
					'2024-07-22 18:58:49',
					'{"list":[]}',
					'{"power_id":"6010921"}',
					'未找到上级菜单数据！请反馈管理员。'
				)

			
2024-07-22 18:58:49 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 未找到上级菜单数据！请反馈管理员。
2024-07-22 18:58:53 接收到POST请求
2024-07-22 18:58:53 http://weixin.xiayukun.asia:444/?signature=7312fa329f7281ef35ad786502ab834d48e99b79&timestamp=1721645932&nonce=1214195639&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 18:58:53 Query:{"signature":"7312fa329f7281ef35ad786502ab834d48e99b79","timestamp":"1721645932","nonce":"1214195639","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 18:58:53 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721645932"],"msgtype":["text"],"content":["4"],"msgid":["24648042304521173"]}}
2024-07-22 18:58:53 来文字消息了：4
2024-07-22 18:58:53 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 18:58:53',
						'24648042304521173',
						'4'
					)
		
2024-07-22 18:58:53 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 18:58:53 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 0
			ORDER BY
				sort
			
2024-07-22 18:58:53 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 18:58:53',
					'{"list":[{"id":1,"parent_id":0,"type":"fixed","NO":"1","title":"查询电费余额","sort":1,"bind_param":null,"bind_param_value":"","click_method":"get_powers_balance","build_method":""},{"id":2,"parent_id":0,"type":"fixed","NO":"2","title":"查询电费详单","sort":2,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":3,"parent_id":0,"type":"fixed","NO":"3","title":"电费充值(跳转物业地址)","sort":3,"bind_param":null,"bind_param_value":"","click_method":"power_recharge","build_method":""},{"id":4,"parent_id":0,"type":"fixed","NO":"4","title":"管理电费账户","sort":4,"bind_param":null,"bind_param_value":"","click_method":null,"build_method":""},{"id":5,"parent_id":0,"type":"fixed","NO":"0","title":"绑定账户(可绑定多个账户)","sort":5,"bind_param":null,"bind_param_value":"","click_method":"bind_power","build_method":""}]}',
					'{}',
					'请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)
'
				)

			
2024-07-22 18:58:53 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 请输入以下回复(5分钟有效)：
1:查询电费余额
2:查询电费详单
3:电费充值(跳转物业地址)
4:管理电费账户
0:绑定账户(可绑定多个账户)

2024-07-22 18:58:56 接收到POST请求
2024-07-22 18:58:56 http://weixin.xiayukun.asia:444/?signature=85c8767f718f6737cb46b926f8ead5c7570de057&timestamp=1721645935&nonce=1295218405&openid=oTYqx6Q2Y-HHiph03Y-4cXinC3FI
2024-07-22 18:58:56 Query:{"signature":"85c8767f718f6737cb46b926f8ead5c7570de057","timestamp":"1721645935","nonce":"1295218405","openid":"oTYqx6Q2Y-HHiph03Y-4cXinC3FI"}
2024-07-22 18:58:56 Body:{"xml":{"tousername":["gh_df4e42db796c"],"fromusername":["oTYqx6Q2Y-HHiph03Y-4cXinC3FI"],"createtime":["1721645935"],"msgtype":["text"],"content":["4"],"msgid":["24648040484660501"]}}
2024-07-22 18:58:56 来文字消息了：4
2024-07-22 18:58:56 执行sql 
				INSERT INTO wechat_event (
					wechat_id,
					event_id,
					datetime,
					msgid,
					content
				)
				VALUES
					(
						'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
						'text',
						'2024-07-22 18:58:56',
						'24648040484660501',
						'4'
					)
		
2024-07-22 18:58:56 执行sql 
			SELECT
				*
			FROM
				wechat_send_history
			WHERE
				wechat_id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
				AND type in ('menu','end')
				AND datetime >= NOW() - INTERVAL 5 MINUTE
			ORDER BY datetime DESC
			LIMIT 1;
			
2024-07-22 18:58:56 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 4
			ORDER BY
				sort
			
2024-07-22 18:58:56 执行sql 
			SELECT
				power_user.id AS power_id,
				balance,
				kwh_sum,
				update_date,
				remark
			FROM
				power_user
			INNER JOIN mapping_wechat_power ON power_user.id = mapping_wechat_power.power_id
			INNER JOIN wechat_user ON wechat_user.id = mapping_wechat_power.wechat_id
			WHERE
				wechat_user.id = 'oTYqx6Q2Y-HHiph03Y-4cXinC3FI'
		
2024-07-22 18:58:56 执行sql 
			SELECT
				*
			FROM
				wechat_menu
			WHERE
				parent_id = 7
			ORDER BY
				sort
			
2024-07-22 18:58:56 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 18:58:56',
					'{"list":[]}',
					'{"power_id":"6010921"}',
					'请输入以下回复(5分钟有效)：
'
				)

			
2024-07-22 18:58:56 执行sql 
			INSERT INTO wechat_send_history (
				wechat_id,
				type,
				datetime,
				menu,
				menu_params,
				content
			)
			VALUES
				(
					'oTYqx6Q2Y-HHiph03Y-4cXinC3FI',
					'menu',
					'2024-07-22 18:58:56',
					'{"list":[]}',
					'{"power_id":"6010921"}',
					'请输入以下回复(5分钟有效)：
'
				)

			
2024-07-22 18:58:56 向oTYqx6Q2Y-HHiph03Y-4cXinC3FI发送信息：
 请输入以下回复(5分钟有效)：

2024-07-22 19:42:28 接收到GET请求
2024-07-22 19:42:28 http://weixin.xiayukun.asia:444/.git/config
2024-07-22 19:42:28 Query:{}
2024-07-22 19:42:28 Body:{}
{"level":"error","message":"Forever detected script was killed by signal: SIGKILL"}
